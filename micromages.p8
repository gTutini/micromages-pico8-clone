pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
--variables	
x=0
y=0
dx=0
dy=0
w=7
h=7
frm=0
frm_time=0
spr_flip=false
cld_test=0

accel = 0.5
-->8
--update and draw
function _update()
	posx = flr(x/8)
	posy = flr(y/8)
	
	control()
	
	dy+=0.9
end


function _draw()
	cls()
	spr(frm, x, y,1,1,spr_flip)
	animate()
	map(0, 0, 0, 0, 16, 16)
	print("x:"..posx.." y:"..posy,0)
	print("gravity:"..flr(dy), 0, 8)
end
-->8
--animations

function animate()
	if (btn(0)) spr_flip=true
	if (btn(1)) spr_flip=false

	if (flr(dy) < 1 and not(hit(x, y+dy,w,h))) then 
		frm=5
	elseif (flr(dy) > 2 and not(hit(x, y+dy,w,h))) then
	 frm=6
	elseif(btn(0) or btn(1)) then
		if time() - frm_time > .1 then
			frm+=1
			frm_time=time()
		end
	
		if frm > 4 then
			frm=0
		end
	elseif (btn(5) and btn(2)) then frm=8
	elseif (btn(5) and btn(3)) then frm=9
	elseif (btn(5)) then frm=7
	else
		frm=0
	end
end

-->8
--basic moviment
function control()
 if (btn(0)) dx -= accel 
 if (btn(1)) dx += accel 

 if (btnp(4) and hit(x, y+dy,w,h))  dy-=8
 
 if ((not btn(0)) and 
 			(not btn(1))) then
 	dx = 0
 end
  
 if hit(x+dx,y,w,h) then
 	dx=0
 	cld_test=1
 else cld_test = 0
	end
 
 if hit(x,y+dy,w,h) then
 	dy=0
 	cld_test=1
 else cld_test = 0
 end
 
 if (dy > 16) dy=16
 if (dy < -16) dy=-16
 if (dx > 1.5) dx=1.5
 if (dx < -1.5) dx=-1.5
 
 x+=dx 
	y+=dy
end
-->8
--physics
function hit(x,y,w,h)
	cld=false

	for i=x,x+w,w do
		if fget(mget(i/8,y/8))>0 or
					fget(mget(i/8,(y+h)/8))>0 then
		 cld=true
		end
	end
	
	return cld
end
__gfx__
00000000001111101000000000111110000000000001111001111110001111000110070001111110000000000000000000000000000000000000000000000000
00111110011100011111110001110001111111100011000111110001011000101090707011110001000000000000000000000000000000000000000000000000
01100001111090910110001011109091111100010110909111100001110909101000170011100000000000000000000000000000000000000000000000000000
11109090001000010119091010100001011090910110000101009091110000701100110001009090000000000000000000000000000000000000000000000000
10100000011100100010001000010010001000010101001000100000101117071101100000100010000000000000000000000000000000000000000000000000
00710010117111070111010000171107001100100011111101710017001100701101000000017100000000000000000000000000000000000000000000000000
01011107010010101771100700101100017711070071111701011110001000001010010001070700000000000000000000000000000000000000000000000000
00111110000101000010011000001100000100100001101000011010010001000011011010007001000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000006666666566666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bb33bb3b000000006666666566666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbb4b4000000006666666566666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b4bbb4b4000000005555555555555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44bb44b4000000006665666666656666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44b444b4000000006665666666656666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444bb4000000006665666666656666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000005555555555555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000006666666566666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000006666666566666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000006666666566666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000005555555555555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000006665666666656666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000006665666666656666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000006665666666656666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000005555555555555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000010001010000000000000000000000000100010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000022230000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000032330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000022230000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000032330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2223222322232223222322232223222300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3233323332333233323332333233323300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
